<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Factura N° [[${encabezado.id}]]</title>
    <style>
        body { font-family: 'Arial', sans-serif; margin: 40px; background-color: #fff; }
        .invoice-container { max-width: 700px; margin: auto; border: 1px solid #ccc; padding: 30px; box-shadow: 0 0 15px rgba(0,0,0,0.1); }
        .header-recibo { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 10px; }
        .info-block { display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 0.9em; }
        .details-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; font-size: 0.9em; }
        .details-table th, .details-table td { border: 1px solid #f0f0f0; padding: 10px; text-align: left; }
        .details-table th { background-color: #f8f8f8; text-align: center; }
        .totals-section { width: 45%; margin-left: auto; border-top: 2px solid #333; }
        .totals-section td { padding: 8px; border: none; }
        .total-final-row { background-color: #333; color: white; font-size: 1.2em; font-weight: bold; }
    </style>
</head>
<body>

<div class="invoice-container">
    
    <div class="header-recibo">
        <h1>FACTURA DE VENTA</h1>
        <p>N° <span th:text="${encabezado.id}">[ID Factura]</span></p>
        <p>Fecha: <span th:text="${#temporals.format(encabezado.fecha, 'dd-MM-yyyy HH:mm')}"></span></p>
    </div>

    <div class="info-block">
        <div>
            <strong>Cliente:</strong> <span th:text="${encabezado.cliente.Nombre}"></span>
        </div>
        <div>
            <strong>Email:</strong> <span th:text="${encabezado.cliente.emailInstitucional}"></span>
        </div>
    </div>

    <h2>Detalle de la Compra</h2>
    <table class="details-table">
        <thead>
            <tr>
                <th>Producto</th>
                <th>Cant.</th>
                <th>V. Unitario</th>
                <th>Dscto Aplicado</th>
                <th>Total Línea</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="det : ${encabezado.detalles}">
                <td th:text="${det.producto.nombre}">[Nombre Producto]</td> 
                <td th:text="${det.cantidad}" style="text-align: right;"></td>
                <td th:text="${#numbers.formatCurrency(det.valorUnitario)}" style="text-align: right;"></td>
                <td th:text="${#numbers.formatPercent(det.descuento, 1, 2)}" style="text-align: right;"></td> 
                <td th:text="${#numbers.formatCurrency(det.valorTotalPorLinea)}" style="text-align: right;"></td>
            </tr>
        </tbody>
    </table>

    <div class="totals-section">
        <table style="width: 100%; border-collapse: collapse;">
            <tr>
                <td>SUBTOTAL BRUTO:</td>
                <td th:text="${#numbers.formatCurrency(encabezado.subtotal)}" style="text-align: right;"></td>
            </tr>
            <tr>
                <td>DESCUENTO TOTAL:</td>
                <td th:text="${#numbers.formatCurrency(encabezado.descuentoTotal)}" style="text-align: right; color: #e74c3c;"></td>
            </tr>
            <tr class="total-final-row">
                <td>TOTAL A PAGAR:</td>
                <td th:text="${#numbers.formatCurrency(encabezado.total)}" style="text-align: right;"></td>
            </tr>
        </table>
    </div>
    
    <button onclick="window.print()" style="margin-top: 30px; padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px;">
        Imprimir Factura
    </button>
</div>

</body>
</html>